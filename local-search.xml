<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>python爬虫-某电影网站实战</title>
    <link href="/2025/11/21/python%E7%88%AC%E8%99%AB-%E6%9F%90%E7%94%B5%E5%BD%B1%E7%BD%91%E7%AB%99%E5%AE%9E%E6%88%98/"/>
    <url>/2025/11/21/python%E7%88%AC%E8%99%AB-%E6%9F%90%E7%94%B5%E5%BD%B1%E7%BD%91%E7%AB%99%E5%AE%9E%E6%88%98/</url>
    
    <content type="html"><![CDATA[<h1 id="前景导入"><a href="#前景导入" class="headerlink" title="前景导入"></a>前景导入</h1><p>最近闲来无事，研究上了Python爬虫，先后做了几个小例子，最初的打算是看某些视屏的时候，需要会员看不了，很难受，就想着试试，实战难度可想而知，就我目前而言</p><ul><li>腾讯视屏</li><li>爱奇艺<br> 还是不想了，找些电影资源站做一个练手小项目吧</li></ul><h1 id="实操"><a href="#实操" class="headerlink" title="实操"></a>实操</h1><h2 id="环境准备"><a href="#环境准备" class="headerlink" title="环境准备"></a>环境准备</h2><ul><li>vscode 编辑器</li><li>python 3.7</li><li>Edge</li><li>一个电影资源站</li></ul><p> 这里我使用的资源站是<a href="http://vedio.kundihulan.com/">星辰影院</a></p><h3 id="第一步"><a href="#第一步" class="headerlink" title="第一步"></a>第一步</h3><p>打开网站，找到你想看的电影<br><img src="/../images/pasted-5.png" alt="图一"><br>我选的康斯坦丁，点击播放他并打开浏览器的开发者工具按键盘上的 f12<br>点击网络，可以看到以下内容</p><p><img src="/../images/pasted-7.png" alt="图二"></p><p>点击媒体</p><p><img src="/../images/pasted-6.png" alt="图三"><br>请注意 这里我们看到 电影，在web上时大部分都会选择切割为 多个小的ts文件进行传输，使视屏能更快速的缓存以及边看边缓存，如果我们需要下载这个电影，就是说需要把这些不知道有多少个的ts文件下载下来</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs bash">简单分析：随便点开几个切片会发现他们的 Filename 为 <br>https://p.jisuts.com:999/hls/232/20240219/2344954/plist0.ts<br>https://p.jisuts.com:999/hls/232/20240219/2344954/plist1.ts<br>https://p.jisuts.com:999/hls/232/20240219/2344954/plist2.ts<br>https://p.jisuts.com:999/hls/232/20240219/2344954/plist3.ts<br></code></pre></td></tr></table></figure><p>那么相信大家都看到里面的规律了，在这里呢挨个点击下载到本地也是可以的，不过嘛，我们既然学会了爬虫就大可不必用这种笨方法了不是吗<br>所以我写了一个简单的小例子</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">from</span> bs4 <span class="hljs-keyword">import</span> BeautifulSoup<br><br>num = <span class="hljs-number">0</span><br><span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:<br><span class="hljs-comment">#将一个切片地址引用，在规律点进行参数传递    </span><br>    movie_url = <span class="hljs-string">f&quot;https://p.jisuts.com:999/hls/232/20240219/2344954/plist<span class="hljs-subst">&#123;num&#125;</span>.ts&quot;</span><br>    <span class="hljs-built_in">print</span>(movie_url)<br><span class="hljs-comment">#获取movie_url 的状态码 如果状态码为200就代表可以正常访问</span><br>    movie_response = requests.get(movie_url)<br><br>    <span class="hljs-keyword">if</span> movie_response.status_code == <span class="hljs-number">200</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;当前是第<span class="hljs-subst">&#123;num&#125;</span>个切片&quot;</span>)<br><span class="hljs-comment">#将每个切片文件保存下来并按照规范命名</span><br>        <span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(<span class="hljs-string">f&quot;<span class="hljs-subst">&#123;num&#125;</span>.ts&quot;</span>, <span class="hljs-string">&quot;wb&quot;</span>) <span class="hljs-keyword">as</span> f:<br>            f.write(movie_response.content)  <br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;第<span class="hljs-subst">&#123;num&#125;</span>个切片下载完成&quot;</span>)<br>        num += <span class="hljs-number">1</span><br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;请求结束，状态码: <span class="hljs-subst">&#123;movie_response.status_code&#125;</span>&quot;</span>)<br>        <span class="hljs-keyword">break</span><br></code></pre></td></tr></table></figure><p>这段代码在有些情况下可能不适用，或许有些电影站，只想服务于浏览器用户，那在这里的就没有办法使用这段代码 你需要添加一个请求头</p><p><img src="/../images/pasted-8.png" alt="图四"></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs python">header = &#123;<span class="hljs-string">&quot;User-Agent&quot;</span>:<span class="hljs-string">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:131.0) Gecko/20100101 Firefox/131.0&quot;</span>&#125;<br><br><br><span class="hljs-comment">#在你发送请求的时候使用，把我们伪装成一个浏览器用户</span><br>movie_response = requests.get(movie_url，headers=header)<br><br></code></pre></td></tr></table></figure><p>当他下载完成，可以在你的目录下看到很多ts后缀的文件<br>很多哈 看的我密集恐惧症要出来了</p><p>当然了，现在你把这些文件下载下来了，如果你很幸运，这个文件没有加密，那你可以挨个点开直接看了，就是几十秒换一个很麻烦，所以我们要用到工具</p><ul><li>ffmpeg<a href="https://www.gyan.dev/ffmpeg/builds/">下载地址</a></li></ul><p>很不幸，这个视屏包加密的，但是有句话叫 三步之内必有解药，我们回到浏览器中，在开发者工具中找两个东西</p><ul><li>m3u8</li><li>key<br>以这两个为后缀的就是我们的解药</li></ul><p><img src="/../images/pasted-9.png" alt="图五"></p><p><img src="/../images/pasted-10.png" alt="图六"><br>双击把他们下载到ts文件的目录去<br>右键用记事本或其他工具打开<br>index.m3u8的内容</p><p><img src="/../images/pasted-11.png" alt="图七"><br>这里的链接就是我们刚才下载文件的链接，那么我们已经把文件下载下来了，所以链接地址也要改成本地的<br>因为有七百来个ts文件，一个个改要命，我写了个代码来自动去改</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">####文件对于爬虫下来的视屏进行文件路径更换####</span><br><span class="hljs-keyword">import</span> os<br><br><span class="hljs-comment"># 定义文件路径</span><br>file_path = <span class="hljs-string">&#x27;E:/ts/index.m3u8&#x27;</span>  <span class="hljs-comment"># 请将此路径替换为你的文件路径</span><br>local_base_path = <span class="hljs-string">&#x27;E://ts/&#x27;</span>  <span class="hljs-comment"># 请将此路径替换为你本地的绝对路径</span><br><br><span class="hljs-comment"># 读取文件内容</span><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(file_path, <span class="hljs-string">&#x27;r&#x27;</span>, encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>) <span class="hljs-keyword">as</span> file:<br>    lines = file.readlines()<br><br><span class="hljs-comment"># 初始化一个空列表来存储新的行</span><br>new_lines = []<br><br><span class="hljs-comment"># 遍历每一行并进行处理</span><br><span class="hljs-keyword">for</span> i, line <span class="hljs-keyword">in</span> <span class="hljs-built_in">enumerate</span>(lines):<br>    <span class="hljs-comment"># 如果这一行以 &quot;https://&quot; 开头，说明是URL链接</span><br>    <span class="hljs-keyword">if</span> line.startswith(<span class="hljs-string">&#x27;https://&#x27;</span>):<br>        <br>        <span class="hljs-comment"># 根据行号生成新的本地路径</span><br>        new_path = os.path.join(local_base_path, <span class="hljs-string">f&#x27;<span class="hljs-subst">&#123;(i-<span class="hljs-number">6</span>) // <span class="hljs-number">2</span>&#125;</span>.ts&#x27;</span>)<br>        <span class="hljs-comment"># 将新的本地路径添加到新行列表中</span><br>        new_lines.append(new_path + <span class="hljs-string">&#x27;\n&#x27;</span>)<br>    <span class="hljs-keyword">else</span>:<br>        <span class="hljs-comment"># 如果不是URL链接，直接添加到新行列表中</span><br>        new_lines.append(line)<br><br><span class="hljs-comment"># 写回文件</span><br><span class="hljs-keyword">with</span> <span class="hljs-built_in">open</span>(file_path, <span class="hljs-string">&#x27;w&#x27;</span>, encoding=<span class="hljs-string">&#x27;utf-8&#x27;</span>) <span class="hljs-keyword">as</span> file:<br>    file.writelines(new_lines)<br><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;URL替换完成&quot;</span>)<br><br></code></pre></td></tr></table></figure><p>记得把路径改成自己的哦<br>改好之后呢，我们来把他作为参数文件，在你的ts文件目录中打开cmd<br>使用ffmpeg 工具</p><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs powershell">ffmpeg <span class="hljs-literal">-allowed_extensions</span> ALL <span class="hljs-literal">-i</span> index.m3u8 <span class="hljs-literal">-c</span> <span class="hljs-built_in">copy</span> new.mp4<br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>python</category>
      
      <category>爬虫</category>
      
    </categories>
    
    
    <tags>
      
      <tag>python</tag>
      
      <tag>爬虫</tag>
      
      <tag>requests</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>哈哈哈</title>
    <link href="/2025/11/21/hello-world/"/>
    <url>/2025/11/21/hello-world/</url>
    
    <content type="html"><![CDATA[<p>你好</p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>centos搭建dhcp服务</title>
    <link href="/2025/11/21/linux-dhcp%E6%90%AD%E5%BB%BA/"/>
    <url>/2025/11/21/linux-dhcp%E6%90%AD%E5%BB%BA/</url>
    
    <content type="html"><![CDATA[<h1 id="centos搭建dhcp服务"><a href="#centos搭建dhcp服务" class="headerlink" title="centos搭建dhcp服务"></a>centos搭建dhcp服务</h1><h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><h2 id="dhcp是什么意思？"><a href="#dhcp是什么意思？" class="headerlink" title="dhcp是什么意思？"></a>dhcp是什么意思？</h2><blockquote><p>dhcp即动态主机设置协议，是一个局域网的网络协议，使用UDP协议工作。主要是给网络快速自动地分配IP地址，DHCP能够帮助我们将IP地址和相关IP信息分配给网络中计算机。</p><p>dhcp还可以给设备上配置正确的子网掩码，默认网关和DNS服务器信息。由于这些功能，现在几乎每台连接到网络的设备都配置了dhcp。</p><p>DHCP通常被应用在大型的局域网络环境中，主要作用是集中的管理、分配IP地址，使网络环境中的主机动态的获得IP地址、Gateway地址、DNS服务器地址等信息，并能够提升地址的使用率。</p><p>dhcp有以下四个功能：</p><ol><li><p>保证任何IP地址在同一时刻只能由一台DHCP客户机所使用。</p></li><li><p>DHCP应当可以给用户分配永久固定的IP地址。</p></li><li><p>DHCP应当可以同用其他方法获得IP地址的主机共存（如手工配置IP地址的主机）。</p></li><li><p>DHCP服务器应当向现有的BOOTP客户端提供服务。 dhpc的工作原理是将IP地址和IP信息“出租”给网络客户端一段时间。因此DHCP客户端必须通过一系列DHCP消息与DHCP服务器进行交互，主要包括DHCP<br>DISCOVER，DHCP OFFER，DHCP REQUEST和DHCP ACK。</p></li></ol></blockquote><hr><p>好了，废话少说，我们直接开干</p><ul><li><input disabled="" type="checkbox"> 环境：vmware 虚拟机</li><li><input disabled="" type="checkbox"> 数量：2</li><li><input disabled="" type="checkbox"> 节点：controller compute</li><li><input disabled="" type="checkbox"> 网卡模式：net<br> 见图</li></ul><p><img src="/../images/pasted-0.png" alt="图1"></p><h1 id="下载dhcp服务"><a href="#下载dhcp服务" class="headerlink" title="下载dhcp服务"></a>下载dhcp服务</h1><h2 id="配置网卡"><a href="#配置网卡" class="headerlink" title="配置网卡"></a>配置网卡</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@controller ~]# ip a<br>1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000<br>    <span class="hljs-built_in">link</span>/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00<br>    inet 127.0.0.1/8 scope host lo<br>       valid_lft forever preferred_lft forever<br>    inet6 ::1/128 scope host<br>       valid_lft forever preferred_lft forever<br>2: ens33: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast state UP group default qlen 1000<br>    <span class="hljs-built_in">link</span>/ether 00:0c:29:c9:be:62 brd ff:ff:ff:ff:ff:ff<br>    inet 192.168.10.11/24 brd 192.168.10.255 scope global dynamic ens33<br>       valid_lft 85476sec preferred_lft 85476sec<br>    inet6 fe80::20c:29ff:fec9:be62/64 scope <span class="hljs-built_in">link</span><br>       valid_lft forever preferred_lft forever<br>[root@controller ~]# <span class="hljs-built_in">cat</span> /etc/sysconfig/network-scripts/ifcfg-ens33<br>TYPE=<span class="hljs-string">&quot;Ethernet&quot;</span><br>PROXY_METHOD=<span class="hljs-string">&quot;none&quot;</span><br>BROWSER_ONLY=<span class="hljs-string">&quot;no&quot;</span><br>BOOTPROTO=<span class="hljs-string">&quot;dhcp&quot;</span><br>DEFROUTE=<span class="hljs-string">&quot;yes&quot;</span><br>IPV4_FAILURE_FATAL=<span class="hljs-string">&quot;no&quot;</span><br>IPV6INIT=<span class="hljs-string">&quot;yes&quot;</span><br>IPV6_AUTOCONF=<span class="hljs-string">&quot;yes&quot;</span><br>IPV6_DEFROUTE=<span class="hljs-string">&quot;yes&quot;</span><br>IPV6_FAILURE_FATAL=<span class="hljs-string">&quot;no&quot;</span><br>IPV6_ADDR_GEN_MODE=<span class="hljs-string">&quot;stable-privacy&quot;</span><br>NAME=<span class="hljs-string">&quot;ens33&quot;</span><br>UUID=<span class="hljs-string">&quot;f7c83436-f055-442c-9425-64a1209d659e&quot;</span><br>DEVICE=<span class="hljs-string">&quot;ens33&quot;</span><br>ONBOOT=<span class="hljs-string">&quot;yes&quot;</span><br>IPADDR=<span class="hljs-string">&quot;192.168.10.11&quot;</span>         <span class="hljs-comment">#固定ip</span><br>PREFIX=<span class="hljs-string">&quot;24&quot;</span>                    <span class="hljs-comment">#子网掩码24位</span><br>GATEWAY=<span class="hljs-string">&quot;192.168.10.2&quot;</span>         <span class="hljs-comment">#网关</span><br></code></pre></td></tr></table></figure><p>网卡配置完成后我们直接下载服务</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@controller ~]# yum install dhcp -y<br></code></pre></td></tr></table></figure><p>步骤没问题哦，如果你有报错会有两个原因</p><pre><code class="hljs">  1.有网环境：网卡配置出错，未能连接外网  2.无外网环境：未配置本地yum源</code></pre><ul><li>其实有没有网配置本地yum都可以下载（本来想找外链，想想质量分还是自己写吧）</li></ul><h2 id="配置本地yum源"><a href="#配置本地yum源" class="headerlink" title="配置本地yum源"></a>配置本地yum源</h2><p>先挂镜像</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@controller ~]# mount /dev/cdrom /mnt/  <span class="hljs-comment">#挂载镜像</span><br>mount: /dev/sr0 写保护，将以只读方式挂载<br>[root@controller ~]# <span class="hljs-built_in">mkdir</span> /opt/centos       <span class="hljs-comment">#创建一个文件夹</span><br>[root@controller ~]# <span class="hljs-built_in">cp</span> /mnt/* /opt/centos/  <span class="hljs-comment">#镜像内容复制到文件夹</span><br></code></pre></td></tr></table></figure><p>再写yum.repo文件</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@controller ~]# vim /etc/yum.repos.d/centos.repo<br><br>[centos]<br>name=centos<br>baseurl=file:///opt/centos<br>gpgcheck=0<br>enabled=1<br></code></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@controller ~]# yum clean all &amp;&amp; yum repolist<br>源标识                                       源名称                                                              状态<br>centos                                       centos                                                               4,070<br></code></pre></td></tr></table></figure><p>ok，回去下载吧</p><h1 id="配置dhcp文件"><a href="#配置dhcp文件" class="headerlink" title="配置dhcp文件"></a>配置dhcp文件</h1><h2 id="复制一个模板"><a href="#复制一个模板" class="headerlink" title="复制一个模板"></a>复制一个模板</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@controller ~]# find / -name dhcpd.conf.example<br>/usr/share/doc/dhcp-4.2.5/dhcpd.conf.example<br>[root@controller ~]# <span class="hljs-built_in">cp</span> /usr/share/doc/dhcp-4.2.5/dhcpd.conf.example /etc/dhcp/dhcpd.conf<br></code></pre></td></tr></table></figure><h2 id="编辑文件"><a href="#编辑文件" class="headerlink" title="编辑文件"></a>编辑文件</h2><p>vim &#x2F;etc&#x2F;dhcp&#x2F;dhcpd.conf</p><blockquote><p>配置文件中你会看到许多这种</p></blockquote><pre><code class="hljs">subnet 192.168.10.0 netmask 255.255.255.0{}</code></pre><p>这个是你要分配的子网，他跟你网卡的网段是一样的，如果你要分配两个或者多个子网的时候你需要有对应数量的网卡哦那么到时候配置文件就是这样的</p><pre><code class="hljs">subnet 192.168.10.0 netmask 255.255.255.0{}subnet 192.168.20.0 netmask 255.255.255.0{}subnet 192.168.30.0 netmask 255.255.255.0{}</code></pre><p>那么我这里仅作例子只写一个</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs bash">subnet 192.168.10.0 netmask 255.255.255.0&#123;<br>  range 192.168.10.50 192.168.10.100;      <span class="hljs-comment">#子网范围</span><br>  option domain-name-servers 8.8.8.8;      <span class="hljs-comment">#dns</span><br>  option domain-name <span class="hljs-string">&quot;internal.example.org&quot;</span>;   <span class="hljs-comment">#域名</span><br>  option routers 192.168.10.2;             <span class="hljs-comment">#网关</span><br>  option broadcast-address 10.5.5.31;      <br>  default-lease-time 600;<br>  max-lease-time 7200;<br>&#125;<br></code></pre></td></tr></table></figure><p>关于配置文件的解读呢，我偷了张图<a href="https://blog.csdn.net/frank_ci/article/details/108758906">出处</a></p><p><img src="/../images/pasted-2.png" alt="图二"></p><h2 id="开启服务"><a href="#开启服务" class="headerlink" title="开启服务"></a>开启服务</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@controller ~]# systemctl restart dhcpd<br>[root@controller ~]# systemctl <span class="hljs-built_in">enable</span> dhcpd<br>Created symlink from /etc/systemd/system/multi-user.target.wants/dhcpd.service to /usr/lib/systemd/system/dhcpd.service.<br></code></pre></td></tr></table></figure><h1 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h1><p>首先我们要将vmware的dhcp关掉<br><img src="/../images/pasted-3.png" alt="图三"><br>下面来到客户机也就是compute<br>没别的意思，打开dhcp就行了<br><strong>BOOTPROTO&#x3D;”dhcp”</strong>   </p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@compute ~]# <span class="hljs-built_in">cat</span> /etc/sysconfig/network-scripts/ifcfg-ens33<br>TYPE=<span class="hljs-string">&quot;Ethernet&quot;</span><br>PROXY_METHOD=<span class="hljs-string">&quot;none&quot;</span><br>BROWSER_ONLY=<span class="hljs-string">&quot;no&quot;</span><br>BOOTPROTO=<span class="hljs-string">&quot;dhcp&quot;</span>    <br>DEFROUTE=<span class="hljs-string">&quot;yes&quot;</span><br>IPV4_FAILURE_FATAL=<span class="hljs-string">&quot;no&quot;</span><br>IPV6INIT=<span class="hljs-string">&quot;yes&quot;</span><br>IPV6_AUTOCONF=<span class="hljs-string">&quot;yes&quot;</span><br>IPV6_DEFROUTE=<span class="hljs-string">&quot;yes&quot;</span><br>IPV6_FAILURE_FATAL=<span class="hljs-string">&quot;no&quot;</span><br>IPV6_ADDR_GEN_MODE=<span class="hljs-string">&quot;stable-privacy&quot;</span><br>NAME=<span class="hljs-string">&quot;ens33&quot;</span><br>UUID=<span class="hljs-string">&quot;d5677465-8888-4277-abff-db622fefb6bd&quot;</span><br>DEVICE=<span class="hljs-string">&quot;ens33&quot;</span><br>ONBOOT=<span class="hljs-string">&quot;yes&quot;</span><br>IPV6_PRIVACY=<span class="hljs-string">&quot;no&quot;</span><br></code></pre></td></tr></table></figure><p>然后重启网卡<br>再看ip</p><p><img src="/../images/pasted-4.png" alt="图四"><br>ok啦</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs bash">[root@compute ~]# ping 192.168.10.11<br>PING 192.168.10.11 (192.168.10.11) 56(84) bytes of data.<br>64 bytes from 192.168.10.11: icmp_seq=1 ttl=64 <span class="hljs-keyword">time</span>=0.364 ms<br>64 bytes from 192.168.10.11: icmp_seq=2 ttl=64 <span class="hljs-keyword">time</span>=0.488 ms<br>64 bytes from 192.168.10.11: icmp_seq=3 ttl=64 <span class="hljs-keyword">time</span>=0.527 ms<br>64 bytes from 192.168.10.11: icmp_seq=4 ttl=64 <span class="hljs-keyword">time</span>=0.354 ms<br>^C<br>--- 192.168.10.11 ping statistics ---<br>4 packets transmitted, 4 received, 0% packet loss, <span class="hljs-keyword">time</span> 3001ms<br>rtt min/avg/max/mdev = 0.354/0.433/0.527/0.077 ms<br>[root@compute ~]#<br></code></pre></td></tr></table></figure><h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>那就到这啦，请叫我不待，拜拜~</p><blockquote><p>你是不是很好奇为什么两台机器明明没什么关联他dhcp分配却能得到ip呢，其实选择相同的网卡也就相当与物理环境中使用同一根网线相连或在一个局域网中，那么我们的机器打开dhcp后会自动搜索局域网内的dhcp服务，发送请求这个时候他没有ip也就是0.0.0.0，说白了就是到处发，完事dhcp服务器收到请求会回复他，并且附上ip大礼包~~</p></blockquote>]]></content>
    
    
    <categories>
      
      <category>linux基础</category>
      
    </categories>
    
    
    <tags>
      
      <tag>linux</tag>
      
      <tag>云计算</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
